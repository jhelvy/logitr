<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Predicting Probabilities and Outcomes with Estimated Models • logitr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Predicting Probabilities and Outcomes with Estimated Models">
<meta property="og:description" content="logitr">
<meta property="og:image" content="https://jhelvy.github.io/logitr/reference/figures/logo.png">
<meta property="og:image:alt" content="Logo for the logitr package">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@JohnHelveston">
<meta name="twitter:site" content="@JohnHelveston">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">logitr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/basic_usage.html">Basic Usage</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/utility_models.html">Utility Models in the Preference &amp; WTP Space</a>
    </li>
    <li>
      <a href="../articles/data_formatting.html">Data Formatting and Encoding</a>
    </li>
    <li>
      <a href="../articles/mnl_models.html">Estimating Multinomial Logit Models</a>
    </li>
    <li>
      <a href="../articles/mxl_models.html">Estimating Mixed Logit Models</a>
    </li>
    <li>
      <a href="../articles/interactions.html">Estimating Models with Interactions</a>
    </li>
    <li>
      <a href="../articles/mnl_models_weighted.html">Estimating Weighted Logit Models</a>
    </li>
    <li>
      <a href="../articles/predict.html">Predicting Probabilities and Outcomes with Estimated Models</a>
    </li>
    <li>
      <a href="../articles/summarizing_results.html">Summarizing Results</a>
    </li>
    <li>
      <a href="../articles/benchmark.html">Benchmarking estimation speed against other packages</a>
    </li>
    <li>
      <a href="../articles/convergence.html">WTP space convergence issues in other packages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jhelvy/logitr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Predicting Probabilities and Outcomes with
Estimated Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhelvy/logitr/blob/HEAD/vignettes/predict.Rmd" class="external-link"><code>vignettes/predict.Rmd</code></a></small>
      <div class="hidden name"><code>predict.Rmd</code></div>

    </div>

    
    
<p>Once a model has been estimated, it can be used to predict
probabilities and / or outcomes for a set of alternatives. This vignette
demonstrates examples of how to so using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
method along with an estimated model.</p>
<p>You can make predictions for any set of alternatives, so long as the
columns in the alternatives correspond to estimated coefficients in your
model. By default, if no new data are provided via the
<code>newdata</code> argument, then predictions will be made for the
original data used to estimate the model.</p>
<p>Predictions can be made using both preference space and WTP space
models, as well as multinomial logit and mixed logit models. For mixed
logit models, heterogeneity is modeled by simulating draws from the
population estimates of the estimated model.</p>
<div class="section level2">
<h2 id="predicting-probabilities">Predicting probabilities<a class="anchor" aria-label="anchor" href="#predicting-probabilities"></a>
</h2>
<div class="section level3">
<h3 id="preference-space-models">Preference space models<a class="anchor" aria-label="anchor" href="#preference-space-models"></a>
</h3>
<p>In the example below, a preference space MNL model is estimated
(<code>mnl_pref</code>) and then used to predict probabilities for the
data used to estimate the model:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/jhelvy/logitr" class="external-link">"logitr"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mnl_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span></span>
<span>  data    <span class="op">=</span> <span class="va">yogurt</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">'choice'</span>,</span>
<span>  obsID   <span class="op">=</span> <span class="st">'obsID'</span>,</span>
<span>  pars    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'price'</span>, <span class="st">'feat'</span>, <span class="st">'brand'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mnl_pref</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="co">#&gt;   obsID predicted_prob</span></span>
<span><span class="co">#&gt; 1     1     0.41802407</span></span>
<span><span class="co">#&gt; 2     1     0.02118240</span></span>
<span><span class="co">#&gt; 3     1     0.23691737</span></span>
<span><span class="co">#&gt; 4     1     0.32387615</span></span>
<span><span class="co">#&gt; 5     2     0.26643822</span></span>
<span><span class="co">#&gt; 6     2     0.02255486</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method returns a data frame containing the
observation ID as well as the predicted probabilities. The original data
can also be returned in the data frame by setting
<code>returnData = TRUE</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mnl_pref</span>, returnData <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="co">#&gt;   obsID predicted_prob price feat brandhiland brandweight brandyoplait choice</span></span>
<span><span class="co">#&gt; 1     1     0.41802407   8.1    0           0           0            0      0</span></span>
<span><span class="co">#&gt; 2     1     0.02118240   6.1    0           1           0            0      0</span></span>
<span><span class="co">#&gt; 3     1     0.23691737   7.9    0           0           1            0      1</span></span>
<span><span class="co">#&gt; 4     1     0.32387615  10.8    0           0           0            1      0</span></span>
<span><span class="co">#&gt; 5     2     0.26643822   9.8    0           0           0            0      1</span></span>
<span><span class="co">#&gt; 6     2     0.02255486   6.4    0           1           0            0      0</span></span></code></pre></div>
<p>To make predictions for a new set of alternatives, use the
<code>newdata</code> argument. The example below makes predictions for
just two of the choice observations from the <code>yogurt</code>
dataset:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>  <span class="va">yogurt</span>, <span class="va">obsID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'obsID'</span>, <span class="st">'alt'</span>, <span class="st">'price'</span>, <span class="st">'feat'</span>, <span class="st">'brand'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">probs_mnl_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">mnl_pref</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">data</span>,</span>
<span>  obsID <span class="op">=</span> <span class="st">"obsID"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">probs_mnl_pref</span></span>
<span><span class="co">#&gt;     obsID predicted_prob</span></span>
<span><span class="co">#&gt; 49     13     0.43685145</span></span>
<span><span class="co">#&gt; 50     13     0.03312986</span></span>
<span><span class="co">#&gt; 51     13     0.19155548</span></span>
<span><span class="co">#&gt; 52     13     0.33846321</span></span>
<span><span class="co">#&gt; 165    42     0.60764778</span></span>
<span><span class="co">#&gt; 166    42     0.02602007</span></span>
<span><span class="co">#&gt; 167    42     0.17803313</span></span>
<span><span class="co">#&gt; 168    42     0.18829902</span></span></code></pre></div>
<p>Upper and lower bounds of a confidence interval for predicted
probabilities can be obtained by setting
<code>interval = "confidence"</code>, and the tolerance level (0 to 1)
is set with the <code>level</code> argument (defaults to 0.95).
Intervals are estimated using the Krinsky and Robb parametric
bootstrapping method <span class="citation">(Krinsky and Robb
1986)</span>. For example, a 95% CI is obtained with the following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probs_mnl_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">mnl_pref</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">data</span>,</span>
<span>  obsID <span class="op">=</span> <span class="st">"obsID"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"confidence"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">probs_mnl_pref</span></span>
<span><span class="co">#&gt;     obsID predicted_prob predicted_prob_lower predicted_prob_upper</span></span>
<span><span class="co">#&gt; 49     13     0.43685145           0.41531882           0.45781528</span></span>
<span><span class="co">#&gt; 50     13     0.03312986           0.02641062           0.04145166</span></span>
<span><span class="co">#&gt; 51     13     0.19155548           0.17631579           0.20767134</span></span>
<span><span class="co">#&gt; 52     13     0.33846321           0.31843584           0.35880858</span></span>
<span><span class="co">#&gt; 165    42     0.60764778           0.57215830           0.64005061</span></span>
<span><span class="co">#&gt; 166    42     0.02602007           0.01839510           0.03687359</span></span>
<span><span class="co">#&gt; 167    42     0.17803313           0.16214868           0.19488167</span></span>
<span><span class="co">#&gt; 168    42     0.18829902           0.16837249           0.20967085</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="wtp-space-models">WTP space models<a class="anchor" aria-label="anchor" href="#wtp-space-models"></a>
</h3>
<p>WTP space models can also be used to predict probabilities. In the
example below, a WTP space model is estimated and used to predict
probabilities for the same <code>data</code> data frame as in the
previous examples:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mnl_wtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span></span>
<span>  data     <span class="op">=</span> <span class="va">yogurt</span>,</span>
<span>  outcome  <span class="op">=</span> <span class="st">'choice'</span>,</span>
<span>  obsID    <span class="op">=</span> <span class="st">'obsID'</span>,</span>
<span>  pars     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'feat'</span>, <span class="st">'brand'</span><span class="op">)</span>,</span>
<span>  scalePar <span class="op">=</span> <span class="st">'price'</span>,</span>
<span>  numMultiStarts <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">probs_mnl_wtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">mnl_wtp</span>,</span>
<span>  newdata  <span class="op">=</span> <span class="va">data</span>,</span>
<span>  obsID    <span class="op">=</span> <span class="st">"obsID"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"confidence"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">probs_mnl_wtp</span></span>
<span><span class="co">#&gt;     obsID predicted_prob predicted_prob_lower predicted_prob_upper</span></span>
<span><span class="co">#&gt; 49     13     0.43686141           0.41551327           0.45747039</span></span>
<span><span class="co">#&gt; 50     13     0.03312947           0.02641714           0.04231684</span></span>
<span><span class="co">#&gt; 51     13     0.19154829           0.17587927           0.20730602</span></span>
<span><span class="co">#&gt; 52     13     0.33846083           0.31857077           0.35854611</span></span>
<span><span class="co">#&gt; 165    42     0.60767120           0.57326014           0.63983775</span></span>
<span><span class="co">#&gt; 166    42     0.02601800           0.01853595           0.03664343</span></span>
<span><span class="co">#&gt; 167    42     0.17802363           0.16178241           0.19419803</span></span>
<span><span class="co">#&gt; 168    42     0.18828717           0.16779265           0.20839887</span></span></code></pre></div>
<p>Here is a bar chart comparing the predicted probabilities from the
preference space and WTP space models. Since both models are equivalent
except in different spaces, the predicted probabilities are
identical:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">probs_mnl_pref</span>, <span class="va">probs_mnl_wtp</span><span class="op">)</span></span>
<span><span class="va">probs</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"mnl_pref"</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"mnl_wtp"</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">probs</span><span class="op">$</span><span class="va">alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dannon"</span>, <span class="st">"hiland"</span>, <span class="st">"weight"</span>, <span class="st">"yoplait"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">probs</span><span class="op">$</span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Observation ID: "</span>, <span class="va">probs</span><span class="op">$</span><span class="va">obsID</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">probs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">alt</span>, y <span class="op">=</span> <span class="va">predicted_prob</span>, fill <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'identity'</span>, width <span class="op">=</span> <span class="fl">0.7</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">predicted_prob_lower</span>, ymax <span class="op">=</span> <span class="va">predicted_prob_upper</span><span class="op">)</span>,</span>
<span>                  width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Alternative'</span>, y <span class="op">=</span> <span class="st">'Expected Choice Probabilities'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="probs.png"><!-- --></p>
</div>
</div>
<div class="section level2">
<h2 id="predicting-outcomes">Predicting outcomes<a class="anchor" aria-label="anchor" href="#predicting-outcomes"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method can also be used to predict
outcomes by setting <code>type = "outcome"</code> (the default is
<code>"prob"</code> for predicting probabilities). In the examples
below, outcomes are predicted using the same preference space and WTP
space models as in the previous examples. The <code>returnData</code>
argument is also set to <code>TRUE</code> so that the predicted outcomes
can be compared to the actual choices made:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomes_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>    <span class="va">mnl_pref</span>, </span>
<span>    type <span class="op">=</span> <span class="st">"outcome"</span>, </span>
<span>    returnData <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">outcomes_pref</span><span class="op">)</span></span>
<span><span class="co">#&gt;   obsID predicted_outcome price feat brandhiland brandweight brandyoplait</span></span>
<span><span class="co">#&gt; 1     1                 0   8.1    0           0           0            0</span></span>
<span><span class="co">#&gt; 2     1                 0   6.1    0           1           0            0</span></span>
<span><span class="co">#&gt; 3     1                 1   7.9    0           0           1            0</span></span>
<span><span class="co">#&gt; 4     1                 0  10.8    0           0           0            1</span></span>
<span><span class="co">#&gt; 5     2                 1   9.8    0           0           0            0</span></span>
<span><span class="co">#&gt; 6     2                 0   6.4    0           1           0            0</span></span>
<span><span class="co">#&gt;   choice</span></span>
<span><span class="co">#&gt; 1      0</span></span>
<span><span class="co">#&gt; 2      0</span></span>
<span><span class="co">#&gt; 3      1</span></span>
<span><span class="co">#&gt; 4      0</span></span>
<span><span class="co">#&gt; 5      1</span></span>
<span><span class="co">#&gt; 6      0</span></span>
<span></span>
<span><span class="va">outcomes_wtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>    <span class="va">mnl_wtp</span>, </span>
<span>    type <span class="op">=</span> <span class="st">"outcome"</span>, </span>
<span>    returnData <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">outcomes_wtp</span><span class="op">)</span></span>
<span><span class="co">#&gt;   obsID predicted_outcome feat brandhiland brandweight brandyoplait scalePar</span></span>
<span><span class="co">#&gt; 1     1                 1    0           0           0            0      8.1</span></span>
<span><span class="co">#&gt; 2     1                 0    0           1           0            0      6.1</span></span>
<span><span class="co">#&gt; 3     1                 0    0           0           1            0      7.9</span></span>
<span><span class="co">#&gt; 4     1                 0    0           0           0            1     10.8</span></span>
<span><span class="co">#&gt; 5     2                 1    0           0           0            0      9.8</span></span>
<span><span class="co">#&gt; 6     2                 0    0           1           0            0      6.4</span></span>
<span><span class="co">#&gt;   choice</span></span>
<span><span class="co">#&gt; 1      0</span></span>
<span><span class="co">#&gt; 2      0</span></span>
<span><span class="co">#&gt; 3      1</span></span>
<span><span class="co">#&gt; 4      0</span></span>
<span><span class="co">#&gt; 5      1</span></span>
<span><span class="co">#&gt; 6      0</span></span></code></pre></div>
<p>The accuracy of each model can be computed by dividing the number of
correctly predicted choices by the total number of choices:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chosen_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">outcomes_pref</span>, <span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">chosen_pref</span><span class="op">$</span><span class="va">correct</span> <span class="op">&lt;-</span> <span class="va">chosen_pref</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="va">chosen_pref</span><span class="op">$</span><span class="va">predicted_outcome</span></span>
<span><span class="va">accuracy_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">chosen_pref</span><span class="op">$</span><span class="va">correct</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">chosen_pref</span><span class="op">)</span></span>
<span><span class="va">accuracy_pref</span></span>
<span><span class="co">#&gt; [1] 0.3909619</span></span>
<span></span>
<span><span class="va">chosen_wtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">outcomes_wtp</span>, <span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">chosen_wtp</span><span class="op">$</span><span class="va">correct</span> <span class="op">&lt;-</span> <span class="va">chosen_wtp</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="va">chosen_wtp</span><span class="op">$</span><span class="va">predicted_outcome</span></span>
<span><span class="va">accuracy_wtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">chosen_wtp</span><span class="op">$</span><span class="va">correct</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">chosen_wtp</span><span class="op">)</span></span>
<span><span class="va">accuracy_wtp</span></span>
<span><span class="co">#&gt; [1] 0.356136</span></span></code></pre></div>
<p>These results show that both models correctly predicted choice for
approximately 39% of the observations in the <code>yogurt</code> data
frame, which is significantly better than random (25%).</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Krinsky1986" class="csl-entry">
Krinsky, Itzhak, and A Leslie Robb. 1986. <span>“On Approximating the
Statistical Properties of Elasticities.”</span> <em>The Review of
Economics and Statistics</em>, 715–19.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John Helveston.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
