<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Usage • logitr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic Usage">
<meta property="og:description" content="logitr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">logitr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/basic_usage.html">Basic Usage</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/utility_models.html">Utility Models in the Preference &amp; WTP Space</a>
    </li>
    <li>
      <a href="../articles/data_formatting.html">Data Formatting and Encoding</a>
    </li>
    <li>
      <a href="../articles/mnl_models.html">Estimating Multinomial Logit Models</a>
    </li>
    <li>
      <a href="../articles/mxl_models.html">Estimating Mixed Logit Models</a>
    </li>
    <li>
      <a href="../articles/interactions.html">Estimating Models with Interactions</a>
    </li>
    <li>
      <a href="../articles/mnl_models_weighted.html">Estimating Weighted Logit Models</a>
    </li>
    <li>
      <a href="../articles/predict_probs.html">Predicting Choice Probabilities from Estimated Models</a>
    </li>
    <li>
      <a href="../articles/predict_choices.html">Predicting Choices from Estimated Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/jhelvy/logitr">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jhelvy/logitr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="basic_usage_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic Usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhelvy/logitr/blob/master/vignettes/basic_usage.Rmd"><code>vignettes/basic_usage.Rmd</code></a></small>
      <div class="hidden name"><code>basic_usage.Rmd</code></div>

    </div>

    
    

<div id="estimating-models" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-models" class="anchor"></a>Estimating models</h1>
<p>The <code><a href="../reference/logitr.html">logitr()</a></code> function estimates multinomial logit (MNL) and mixed logit (MXL) models using “Preference” space or “Willingness-to-pay (WTP)” space <a href="utility_models.html">utility parameterizations</a>. The basic usage for estimating models is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">choiceName</span>,
  <span class="va">obsIDName</span>,
  <span class="va">parNames</span>,
  priceName <span class="op">=</span> <span class="cn">NULL</span>,
  randPars <span class="op">=</span> <span class="cn">NULL</span>,
  randPrice <span class="op">=</span> <span class="cn">NULL</span>,
  modelSpace <span class="op">=</span> <span class="st">"pref"</span>,
  weightsName <span class="op">=</span> <span class="cn">NULL</span>,
  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The <code>data</code> argument must be provided a <code>data.frame</code> arranged in “long” or “tidy” format <span class="citation">[@Wickham2014]</span>. Each row should be an alternative from a choice observation. The choice observations do not have to be symmetric (i.e. each choice observation could have a different number of alternatives). The data must also include variables for each of the following arguments in the <code><a href="../reference/logitr.html">logitr()</a></code> function:</p>
<ul>
<li>
<code>choiceName</code>: A dummy variable that identifies which alternative was chosen (<code>1</code> is chosen, <code>0</code> is not chosen). Only one alternative should be chosen per choice observation.</li>
<li>
<code>obsIDName</code>: A sequence of repeated numbers that identifies each unique choice observation For example, if the first three choice observations had 2 alternatives each, then the first 6 rows of the <code>obsID</code> variable would be <code>1, 1, 2, 2, 3, 3</code>.</li>
<li>
<code>parNames</code>: The names of the variables that will be used as model covariates. For WTP space models, the price variable should <strong>not</strong> be included in <code>parNames</code> as it is provided separately with the <code>priceName</code> argument.</li>
</ul>
<p>The <a href="data_formatting.html">“Data Formatting and Encoding”</a> vignette has more details about the required data format.</p>
</div>
<div id="preference-space-models" class="section level2">
<h2 class="hasAnchor">
<a href="#preference-space-models" class="anchor"></a>Preference space models</h2>
<p>The <code><a href="../reference/logitr.html">logitr()</a></code> function assumes that the deterministic part of the utility function, <span class="math inline">\(v_{j}\)</span>, is linear in parameters, i.e.:</p>
<p><span class="math display">\[\begin{equation}
    u_{j} = v_{j} + \varepsilon_{j}
        \hspace{0.5in}
        \varepsilon_{j} \sim \textrm{Gumbel}\left(0,\frac{\pi^2}{6}\right)
\label{eq:utilityComponents}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    v_{j} =
        \mathbf{β}' \mathrm{\mathbf{x}}_{j} +
        \alpha p_{j}
        \hspace{0.5in}
\label{eq:utilityPreferenceObserved}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathbf{β}\)</span> is the vector of coefficients for non-price attributes <span class="math inline">\(\mathrm{\mathbf{x}}_{j}\)</span>, <span class="math inline">\(\alpha\)</span> is the coefficient for price <span class="math inline">\(p_{j}\)</span>. Accordingly, each parameter in the <code>parNames</code> argument is an additive part of <span class="math inline">\(v_{j}\)</span>.</p>
<p>For example, if the observed utility for yogurt purchases was <span class="math inline">\(v_{j} = \beta x_{j} + \alpha p_{j}\)</span>, where <span class="math inline">\(p_{j}\)</span> is “price” and <span class="math inline">\(x_{j}\)</span> is “brand”, then the <code>parNames</code> argument should be <code><a href="https://rdrr.io/r/base/c.html">c("price", "brand")</a></code>. This model can be estimated as follows using the <code>yogurt</code> data frame:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>mnl_pref &lt;-<span class="st"> </span><span class="kw">logitr</span>(</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="dt">data       =</span> yogurt,</span>
<span id="cb2-3"><a href="#cb2-3"></a>    <span class="dt">choiceName =</span> <span class="st">"choice"</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span class="dt">obsIDName  =</span> <span class="st">"obsID"</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>    <span class="dt">parNames   =</span> <span class="kw">c</span>(<span class="st">"price"</span>, <span class="st">"brand"</span>))</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="er">)</span></span></code></pre></div>
<p>Use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function to view a summary of the estimated model results. In the following summary, three coefficients are shown for the “brand” attribute, with <code>"dannon"</code> set as the reference level:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mnl_pref</span><span class="op">)</span>
<span class="co">#&gt; =================================================</span>
<span class="co">#&gt; MODEL SUMMARY: </span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt; Model Space:    Preference</span>
<span class="co">#&gt; Model Run:          1 of 1</span>
<span class="co">#&gt; Iterations:             21</span>
<span class="co">#&gt; Elapsed Time:  0h:0m:0.13s</span>
<span class="co">#&gt; Exit Status:             3</span>
<span class="co">#&gt; Weights Used?:       FALSE</span>
<span class="co">#&gt; robust?              FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model Coefficients: </span>
<span class="co">#&gt;               Estimate StdError    tStat pVal signif</span>
<span class="co">#&gt; price        -0.366543 0.024365 -15.0439    0    ***</span>
<span class="co">#&gt; feat          0.491433 0.120061   4.0932    0    ***</span>
<span class="co">#&gt; brandhiland  -3.715428 0.145416 -25.5504    0    ***</span>
<span class="co">#&gt; brandweight  -0.641128 0.054498 -11.7643    0    ***</span>
<span class="co">#&gt; brandyoplait  0.734496 0.080642   9.1082    0    ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model Fit Values: </span>
<span class="co">#&gt;                                      </span>
<span class="co">#&gt; Log-Likelihood:         -2656.8878799</span>
<span class="co">#&gt; Null Log-Likelihood:    -3343.7419990</span>
<span class="co">#&gt; AIC:                     5323.7758000</span>
<span class="co">#&gt; BIC:                     5352.7168000</span>
<span class="co">#&gt; McFadden R2:                0.2054148</span>
<span class="co">#&gt; Adj McFadden R2:            0.2039195</span>
<span class="co">#&gt; Number of Observations:  2412.0000000</span></code></pre></div>
</div>
<div id="wtp-space-models" class="section level2">
<h2 class="hasAnchor">
<a href="#wtp-space-models" class="anchor"></a>WTP space models</h2>
<p>For models estimated in the WTP space, the <code>modelSpace</code> argument should be set to <code>"wtp"</code>. In addition, the <code>parNames</code> argument should <em>not</em> contain the name of the column for the price attribute because there is no estimated “price” parameter in WTP space models. Instead, a “scale” parameter given by <span class="math inline">\(\lambda\)</span> will be estimated, and the column for “price” should be provided separately using the <code>priceName</code> argument.</p>
<p>For example, if the observed utility was <span class="math inline">\(v_{j} = \lambda \left(\omega x_{j} - p_{j}\right)\)</span>, where <span class="math inline">\(p_{j}\)</span> is “price” and <span class="math inline">\(x_{j}\)</span> is “brand”, then the <code>parNames</code> argument should be <code>"brand"</code> and the <code>priceName</code> argument should be <code>"price"</code>. This model can be estimated as follows using the <code>yogurt</code> data frame:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mnl_wtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span>
    data       <span class="op">=</span> <span class="va">yogurt</span>,
    choiceName <span class="op">=</span> <span class="st">"choice"</span>,
    obsIDName  <span class="op">=</span> <span class="st">"obsID"</span>,
    parNames   <span class="op">=</span> <span class="st">"brand"</span>,
    priceName  <span class="op">=</span> <span class="st">"price"</span>,
    modelSpace <span class="op">=</span> <span class="st">"wtp"</span>,
    options    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>numMultiStarts <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Since WTP space models are non-convex, it is recommended to use a multi-start search to run the optimization loop multiple times to search for different local minima. This was implemented in the above example by passing a <code>numMultiStarts</code> argument inside a list to the <code>options</code> argument (other options can be passed in the same list).</p>
<p>In the WTP space model, the estimated “brand” coefficients have units of dollars and can be interpreted as the average willingness to pay for each brand relative to the “Dannon” brand, all else being equal.</p>
</div>
<div id="mixed-logit-models" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-logit-models" class="anchor"></a>Mixed logit models</h2>
<p>To estimate a mixed logit model, use the <code>randPars</code> argument in the <code><a href="../reference/logitr.html">logitr()</a></code> function to denote which parameters will be modeled with a distribution. The current package version supports normal (<code>"n"</code>) and log-normal (<code>"ln"</code>) distributions.</p>
<p>For example, assume the observed utility for yogurts was <span class="math inline">\(v_{j} = \beta x_{j} + \alpha p_{j}\)</span>, where <span class="math inline">\(p_{j}\)</span> is “price” and <span class="math inline">\(x_{j}\)</span> is “brand”. To model <code>"brand"</code> parameter, <span class="math inline">\(\beta\)</span>, with a normal or log-normal distribution, set <code>randPars = c(size = "n")</code> or <code>randPars = c(size = "ln")</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mxl_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span>
    data       <span class="op">=</span> <span class="va">yogurt</span>,
    choiceName <span class="op">=</span> <span class="st">"choice"</span>,
    obsIDName  <span class="op">=</span> <span class="st">"obsID"</span>,
    parNames   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"price"</span>, <span class="st">"brand"</span><span class="op">)</span>,
    randPars   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>brand <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>,
    options    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>numMultiStarts <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Since mixed logit models are non-convex, it is again recommended to use a multi-start search to run the optimization loop multiple times to search for different local minima. Note that mixed logit models can take a long time to estimate, so setting large number for <code>numMultiStarts</code> could take hours or longer to complete.</p>
</div>
<div id="view-results" class="section level2">
<h2 class="hasAnchor">
<a href="#view-results" class="anchor"></a>View results</h2>
<p>Use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function to print a summary of the results from an estimated model. The function will print the following based on the model settings:</p>
<ul>
<li>For a single model run, it prints some summary information, including the model space (Preference or WTP), log-likelihood value at the solution, and a summary table of the model coefficients.</li>
<li>For MXL models, the function also prints a summary of the random parameters.</li>
<li>If you set <code>keepAllRuns = TRUE</code> in the <code>options</code> argument, <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> will print a summary of all the multistart runs followed by a summary of the best model (as determined by the largest log-likelihood value).</li>
</ul>
<p>Use <code><a href="../reference/statusCodes.html">statusCodes()</a></code> to print a description of each status code from the <code>nloptr</code> optimization routine.</p>
</div>
<div id="computing-and-comparing-wtp" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-and-comparing-wtp" class="anchor"></a>Computing and comparing WTP</h2>
<p>For models in the preference space, a summary table of the computed WTP based on the estimated preference space parameters can be obtained with the <code><a href="../reference/wtp.html">wtp()</a></code> function. For example, the computed WTP from the previously estimated fixed parameter model can be obtained with the following command:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wtp.html">wtp</a></span><span class="op">(</span><span class="va">mnl_pref</span>, priceName <span class="op">=</span> <span class="st">"price"</span><span class="op">)</span>
<span class="co">#&gt;                Estimate StdError    tStat  pVal signif</span>
<span class="co">#&gt; lambda         0.366543 0.024261  15.1082 0e+00    ***</span>
<span class="co">#&gt; feat           1.340724 0.359337   3.7311 2e-04    ***</span>
<span class="co">#&gt; brandhiland  -10.136406 0.582927 -17.3888 0e+00    ***</span>
<span class="co">#&gt; brandweight   -1.749121 0.181256  -9.6500 0e+00    ***</span>
<span class="co">#&gt; brandyoplait   2.003848 0.143157  13.9976 0e+00    ***</span></code></pre></div>
<p>The <code><a href="../reference/wtp.html">wtp()</a></code> function divides the non-price parameters by the negative of the price parameter. Standard errors are estimated using the Krinsky and Robb parametric bootstrapping method <span class="citation">[@Krinsky1986]</span>. Similarly, the <code><a href="../reference/wtpCompare.html">wtpCompare()</a></code> function can be used to compare the WTP from a WTP space model with that computed from an equivalent preference space model:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wtpCompare.html">wtpCompare</a></span><span class="op">(</span><span class="va">mnl_pref</span>, <span class="va">mnl_wtp</span>, priceName <span class="op">=</span> <span class="st">"price"</span><span class="op">)</span>
<span class="co">#&gt;                      pref           wtp  difference</span>
<span class="co">#&gt; lambda           0.366543     0.3665854  0.00004238</span>
<span class="co">#&gt; feat             1.340724     1.3405708 -0.00015315</span>
<span class="co">#&gt; brandhiland    -10.136406   -10.1357346  0.00067139</span>
<span class="co">#&gt; brandweight     -1.749121    -1.7490629  0.00005807</span>
<span class="co">#&gt; brandyoplait     2.003848     2.0038178 -0.00003018</span>
<span class="co">#&gt; logLik       -2656.887880 -2656.8878779  0.00000194</span></code></pre></div>
</div>
<div id="making-predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#making-predictions" class="anchor"></a>Making predictions</h2>
<p>Estimated models can be used to predict expected choices and choice probabilities for a set (or multiple sets) of alternatives based on an estimated model. As an example, consider predicting choice probabilities for two of the choice observations from the <code>yogurt</code> dataset:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>
  <span class="va">yogurt</span>, <span class="va">obsID</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">13</span><span class="op">)</span>,
  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'obsID'</span>, <span class="st">'choice'</span>, <span class="st">'price'</span>, <span class="st">'feat'</span>, <span class="st">'brand'</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">alts</span>
<span class="co">#&gt;     obsID choice price feat   brand</span>
<span class="co">#&gt; 49     13      0   8.1    0  dannon</span>
<span class="co">#&gt; 50     13      0   5.0    0  hiland</span>
<span class="co">#&gt; 51     13      1   8.6    0  weight</span>
<span class="co">#&gt; 52     13      0  10.8    0 yoplait</span>
<span class="co">#&gt; 165    42      1   6.3    0  dannon</span>
<span class="co">#&gt; 166    42      0   6.1    1  hiland</span>
<span class="co">#&gt; 167    42      0   7.9    0  weight</span>
<span class="co">#&gt; 168    42      0  11.5    0 yoplait</span></code></pre></div>
<p>In the example below, the expected choice probabilities for these two sets of alternatives are computed using the fixed parameter <code>mnl_pref</code> model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictProbs.html">predictProbs</a></span><span class="op">(</span>
  model     <span class="op">=</span> <span class="va">mnl_pref</span>,
  alts      <span class="op">=</span> <span class="va">alts</span>,
  obsIDName <span class="op">=</span> <span class="st">"obsID"</span>
<span class="op">)</span>

<span class="va">probs</span>
<span class="co">#&gt;     obsID  prob_mean   prob_low  prob_high</span>
<span class="co">#&gt; 49     13 0.43684871 0.41568116 0.45725309</span>
<span class="co">#&gt; 50     13 0.03313009 0.02647332 0.04182538</span>
<span class="co">#&gt; 51     13 0.19155738 0.17625333 0.20774445</span>
<span class="co">#&gt; 52     13 0.33846382 0.31927026 0.35875236</span>
<span class="co">#&gt; 165    42 0.60763975 0.57375423 0.63992109</span>
<span class="co">#&gt; 166    42 0.02602079 0.01844369 0.03636327</span>
<span class="co">#&gt; 167    42 0.17803594 0.16217059 0.19459316</span>
<span class="co">#&gt; 168    42 0.18830353 0.16852409 0.20918156</span></code></pre></div>
<p>The resulting <code>probs</code> data frame contains the expected choice probabilities for each alternative. The low and high values show a 95% confidence interval, estimated using the Krinsky and Robb parametric bootstrapping method <span class="citation">[@Krinsky1986]</span>. You can change the CI level by setting alpha to a different value (e.g. a 90% CI is obtained with alpha = 0.05).</p>
<p>Choice probabilities can also be predicted used WTP space models. For example, the predicted choice probabilities using the <code>mnl_wtp</code> model are nearly identical with those from the <code>mnl_pref</code> model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictProbs.html">predictProbs</a></span><span class="op">(</span>
  model     <span class="op">=</span> <span class="va">mnl_wtp</span>,
  alts      <span class="op">=</span> <span class="va">alts</span>,
  obsIDName <span class="op">=</span> <span class="st">"obsID"</span>
<span class="op">)</span>

<span class="va">probs</span>
<span class="co">#&gt;     obsID  prob_mean   prob_low  prob_high</span>
<span class="co">#&gt; 49     13 0.43686166 0.41536052 0.45745161</span>
<span class="co">#&gt; 50     13 0.03312933 0.02650666 0.04207442</span>
<span class="co">#&gt; 51     13 0.19154885 0.17587430 0.20790447</span>
<span class="co">#&gt; 52     13 0.33846015 0.31840174 0.35883851</span>
<span class="co">#&gt; 165    42 0.60767236 0.57340051 0.64016826</span>
<span class="co">#&gt; 166    42 0.02601763 0.01836585 0.03643752</span>
<span class="co">#&gt; 167    42 0.17802398 0.16177420 0.19477537</span>
<span class="co">#&gt; 168    42 0.18828603 0.16769436 0.20854413</span></code></pre></div>
<p>Similar to the <code><a href="../reference/predictProbs.html">predictProbs()</a></code> function, the <code><a href="../reference/predictChoices.html">predictChoices()</a></code> function can be used to predict choices using the results of an estimated model. In the example below, choices are predicted for the entire <code>yogurt</code> dataset, which was used to the estimate the <code>mnl_pref</code> model:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">choices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictChoices.html">predictChoices</a></span><span class="op">(</span>
  model     <span class="op">=</span> <span class="va">mnl_pref</span>,
  alts      <span class="op">=</span> <span class="va">yogurt</span>,
  obsIDName <span class="op">=</span> <span class="st">"obsID"</span>
<span class="op">)</span>

<span class="co"># Preview actual and predicted choices</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">choices</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'obsID'</span>, <span class="st">'choice'</span>, <span class="st">'choice_predict'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;     obsID choice choice_predict</span>
<span class="co">#&gt; 1.1     1      0              0</span>
<span class="co">#&gt; 1.2     1      0              0</span>
<span class="co">#&gt; 1.3     1      1              1</span>
<span class="co">#&gt; 1.4     1      0              0</span>
<span class="co">#&gt; 2.5     2      1              0</span>
<span class="co">#&gt; 2.6     2      0              0</span></code></pre></div>
<p>The resulting <code>choices</code> data frame contains the same <code>alts</code> data frame with an additional column, <code>choice_predict</code>, which contains the predicted choices. You can quickly compute the accuracy by dividing the number of correctly predicted choices by the total number of choices:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chosen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">choices</span>, <span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">chosen</span><span class="op">$</span><span class="va">correct</span> <span class="op">&lt;-</span> <span class="va">chosen</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="va">chosen</span><span class="op">$</span><span class="va">choice_predict</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">chosen</span><span class="op">$</span><span class="va">correct</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">chosen</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.3623549</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Helveston, Connor Forsythe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
