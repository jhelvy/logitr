<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Usage • logitr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic Usage">
<meta property="og:description" content="logitr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">logitr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/basic_usage.html">Basic Usage</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/utility_models.html">Utility Models in the Preference &amp; WTP Space</a>
    </li>
    <li>
      <a href="../articles/data_formatting.html">Data Formatting and Encoding</a>
    </li>
    <li>
      <a href="../articles/mnl_models.html">Estimating Multinomial Logit Models</a>
    </li>
    <li>
      <a href="../articles/mxl_models.html">Estimating Mixed Logit Models</a>
    </li>
    <li>
      <a href="../articles/interactions.html">Estimating Models with Interactions</a>
    </li>
    <li>
      <a href="../articles/mnl_models_weighted.html">Estimating Weighted Logit Models</a>
    </li>
    <li>
      <a href="../articles/predict_probs.html">Predicting Choice Probabilities from Estimated Models</a>
    </li>
    <li>
      <a href="../articles/predict_choices.html">Predicting Choices from Estimated Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jhelvy/logitr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="basic_usage_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic Usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhelvy/logitr/blob/master/vignettes/basic_usage.Rmd"><code>vignettes/basic_usage.Rmd</code></a></small>
      <div class="hidden name"><code>basic_usage.Rmd</code></div>

    </div>

    
    

<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The {logitr} package requires that data be structured in a <code>data.frame</code> and arranged in “long” or “tidy” format <span class="citation">[@Wickham2014]</span>. Each row should be an alternative from a choice observation. The choice observations do not have to be symmetric, meaning they can have a “ragged” structure where different choice observations have different numbers of alternatives. The data must also include variables for each of the following:</p>
<ul>
<li>
<strong>Choice</strong>: A dummy variable that identifies which alternative was chosen (<code>1</code> is chosen, <code>0</code> is not chosen). Only one alternative should be chosen per choice observation.</li>
<li>
<strong>Observation ID</strong>: A sequence of repeated numbers that identifies each unique choice observation. For example, if the first three choice observations had 2 alternatives each, then the first 6 rows of the <code>obsID</code> variable would be <code>1, 1, 2, 2, 3, 3</code>.</li>
<li>
<strong>Covariates</strong>: Other variables that will be used as model covariates.</li>
</ul>
<p>The <a href="data_formatting.html">“Data Formatting and Encoding”</a> vignette has more details about the required data format.</p>
</div>
<div id="model-specification-interface" class="section level2">
<h2 class="hasAnchor">
<a href="#model-specification-interface" class="anchor"></a>Model specification interface</h2>
<p>Unlike most other similar packages, package {logitr} does not use the <code>formula</code> class to specify the model covariates and instead uses a vector of the covariates names. Each element in the vector is additively included as a covariate in the utility model, with the interpretation that they represent <em>utility</em> parameters in preference space models and <em>WTP</em> parameters in a WTP space model. While this design choice is a departure from the popular formula interface used in other similar packages such as {mlogit}, it was chosen to avoid confusion when switching between estimating preference space and WTP space models.</p>
<p>The basic usage for estimating models is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>model &lt;-<span class="st"> </span><span class="kw">logitr</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>  data,</span>
<span id="cb1-3"><a href="#cb1-3"></a>  choice,</span>
<span id="cb1-4"><a href="#cb1-4"></a>  obsID,</span>
<span id="cb1-5"><a href="#cb1-5"></a>  pars</span>
<span id="cb1-6"><a href="#cb1-6"></a>  ...</span>
<span id="cb1-7"><a href="#cb1-7"></a>)</span></code></pre></div>
<p>For example, consider a preference space model where the observed utility for yogurt purchases is given by <span class="math inline">\(v_{j} = \alpha p_{j} + \beta_1 x_{j1} + \beta_2 x_{j2}\)</span>, where <span class="math inline">\(p_{j}\)</span> is <code>price</code>, <span class="math inline">\(x_{j1}\)</span> is <code>feat</code>, and <span class="math inline">\(x_{j2}\)</span> is <code>brand</code>. This model can be estimated using the <code><a href="../reference/logitr.html">logitr()</a></code> function as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mnl_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span>
    data   <span class="op">=</span> <span class="va">yogurt</span>,
    choice <span class="op">=</span> <span class="st">"choice"</span>,
    obsID  <span class="op">=</span> <span class="st">"obsID"</span>,
    pars   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"price"</span>, <span class="st">"feat"</span>, <span class="st">"brand"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>To instead estimate a WTP space model, the user can simply move the <code>"price"</code> covariate from the <code>pars</code> argument to the <code>price</code> argument and change the <code>modelSpace</code> argument value from <code>"pref"</code> to <code>"wtp"</code> (<code>"pref"</code> is the default value):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mnl_wtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span>
    data   <span class="op">=</span> <span class="va">yogurt</span>,
    choice <span class="op">=</span> <span class="st">"choice"</span>,
    obsID  <span class="op">=</span> <span class="st">"obsID"</span>,
    pars   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"feat"</span>, <span class="st">"brand"</span><span class="op">)</span>,
    price  <span class="op">=</span> <span class="st">"price"</span>,
    modelSpace <span class="op">=</span> <span class="st">"wtp"</span>
<span class="op">)</span></code></pre></div>
<p>In this case, the observed utility is <span class="math inline">\(v_{j} = \lambda \left(\omega_1 x_{j1} + \omega_2 x_{j2} - p_{j}\right)\)</span>, where <span class="math inline">\(p_{j}\)</span> is <code>price</code>, <span class="math inline">\(x_{j1}\)</span> is <code>feat</code>, and <span class="math inline">\(x_{j2}\)</span> is <code>brand</code>.</p>
<p>Note that for WTP space models the <code>pars</code> argument should <em>not</em> contain the name of the column for the price attribute because there is no estimated “price” parameter in WTP space models. Instead, a “scale” parameter given by <span class="math inline">\(\lambda\)</span> will be estimated, and the column for “price” should be provided separately using the <code>price</code> argument.</p>
<p>Both of these examples are multinomial logit models with fixed parameters. See the <a href="mnl_models.html">“Estimating Multinomial Logit Models”</a> vignette for more details.</p>
</div>
<div id="multi-start-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#multi-start-estimation" class="anchor"></a>Multi-start estimation</h2>
<p>Since WTP space models have non-convex log-likelihood functions, it is recommended to use a multi-start search to run the optimization loop multiple times to search for different local minima. This is implemented using the <code>numMultiStarts</code> argument, e.g.:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mnl_wtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span>
    data   <span class="op">=</span> <span class="va">yogurt</span>,
    choice <span class="op">=</span> <span class="st">"choice"</span>,
    obsID  <span class="op">=</span> <span class="st">"obsID"</span>,
    pars   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"feat"</span>, <span class="st">"brand"</span><span class="op">)</span>,
    price  <span class="op">=</span> <span class="st">"price"</span>,
    modelSpace <span class="op">=</span> <span class="st">"wtp"</span>,
    numMultiStarts <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="mixed-logit-models" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-logit-models" class="anchor"></a>Mixed logit models</h2>
<p>To estimate a mixed logit model, use the <code>randPars</code> argument in the <code><a href="../reference/logitr.html">logitr()</a></code> function to denote which parameters will be modeled with a distribution. The current package version supports normal (<code>"n"</code>) and log-normal (<code>"ln"</code>) distributions.</p>
<p>For example, assume the observed utility for yogurts is given by <span class="math inline">\(v_{j} = \alpha p_{j} + \beta_1 x_{j1} + \beta_2 x_{j2}\)</span>, where <span class="math inline">\(p_{j}\)</span> is <code>price</code>, <span class="math inline">\(x_{j1}\)</span> is <code>feat</code>, and <span class="math inline">\(x_{j2}\)</span> is <code>brand</code>. To model the <code>"feat"</code> and <code>"brand"</code> parameters as normally distributed, set <code>randPars = c(feat = 'n', brand = 'n')</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mxl_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logitr.html">logitr</a></span><span class="op">(</span>
    data     <span class="op">=</span> <span class="va">yogurt</span>,
    choice   <span class="op">=</span> <span class="st">'choice'</span>,
    obsID    <span class="op">=</span> <span class="st">'obsID'</span>,
    pars     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'price'</span>, <span class="st">'feat'</span>, <span class="st">'brand'</span><span class="op">)</span>,
    randPars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>feat <span class="op">=</span> <span class="st">'n'</span>, brand <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span>,
    numMultiStarts <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span></code></pre></div>
<p>Since mixed logit models also have non-convex log-likelihood functions, it is again recommended to use a multi-start search to run the optimization loop multiple times to search for different local minima.</p>
<p>See the <a href="mxl_models.html">“Estimating Mixed Logit Models”</a> vignette for more details.</p>
</div>
<div id="view-results" class="section level2">
<h2 class="hasAnchor">
<a href="#view-results" class="anchor"></a>View results</h2>
<p>Use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function to print a summary of the results from an estimated model, e.g.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mnl_pref</span><span class="op">)</span>
<span class="co">#&gt; =================================================</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; logitr(data = yogurt, choice = "choice", obsID = "obsID", pars = c("price", </span>
<span class="co">#&gt;     "feat", "brand"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Frequencies of alternatives:</span>
<span class="co">#&gt;        1        2        3        4 </span>
<span class="co">#&gt; 0.402156 0.029436 0.229270 0.339138 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Exit Status: 3, Optimization stopped because ftol_rel or ftol_abs was reached.</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; Model Type:    Multinomial Logit</span>
<span class="co">#&gt; Model Space:          Preference</span>
<span class="co">#&gt; Model Run:                1 of 1</span>
<span class="co">#&gt; Iterations:                   21</span>
<span class="co">#&gt; Elapsed Time:        0h:0m:0.03s</span>
<span class="co">#&gt; Algorithm:        NLOPT_LD_LBFGS</span>
<span class="co">#&gt; Weights Used?:             FALSE</span>
<span class="co">#&gt; Robust?                    FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model Coefficients: </span>
<span class="co">#&gt;               Estimate Std. Error  z-value  Pr(&gt;|z|)    </span>
<span class="co">#&gt; price        -0.366555   0.024365 -15.0441 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; feat          0.491439   0.120062   4.0932 4.254e-05 ***</span>
<span class="co">#&gt; brandhiland  -3.715477   0.145417 -25.5506 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; brandweight  -0.641138   0.054498 -11.7645 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; brandyoplait  0.734519   0.080642   9.1084 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt;                                      </span>
<span class="co">#&gt; Log-Likelihood:         -2656.8878790</span>
<span class="co">#&gt; Null Log-Likelihood:    -3343.7419990</span>
<span class="co">#&gt; AIC:                     5323.7758000</span>
<span class="co">#&gt; BIC:                     5352.7168000</span>
<span class="co">#&gt; McFadden R2:                0.2054148</span>
<span class="co">#&gt; Adj McFadden R2:            0.2039195</span>
<span class="co">#&gt; Number of Observations:  2412.0000000</span></code></pre></div>
<p>Use <code><a href="../reference/statusCodes.html">statusCodes()</a></code> to print a description of each status code from the <code>nloptr</code> optimization routine.</p>
<p>You can also extract other values of interest at the solution, such as:</p>
<p><strong>The estimated coefficients</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mnl_pref</span><span class="op">)</span>
<span class="co">#&gt;        price         feat  brandhiland  brandweight brandyoplait </span>
<span class="co">#&gt;   -0.3665546    0.4914392   -3.7154773   -0.6411384    0.7345195</span></code></pre></div>
<p><strong>The log-likelihood</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">mnl_pref</span><span class="op">)</span>
<span class="co">#&gt; [1] -2656.888</span></code></pre></div>
<p><strong>The variance-covariance matrix</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">mnl_pref</span><span class="op">)</span>
<span class="co">#&gt;                      price          feat  brandhiland  brandweight</span>
<span class="co">#&gt; price         0.0005936657  5.729619e-04  0.001851795 1.249988e-04</span>
<span class="co">#&gt; feat          0.0005729619  1.441482e-02  0.000855011 5.092010e-06</span>
<span class="co">#&gt; brandhiland   0.0018517954  8.550110e-04  0.021146019 1.490080e-03</span>
<span class="co">#&gt; brandweight   0.0001249988  5.092009e-06  0.001490080 2.970026e-03</span>
<span class="co">#&gt; brandyoplait -0.0015377720 -1.821331e-03 -0.003681036 7.779428e-04</span>
<span class="co">#&gt;               brandyoplait</span>
<span class="co">#&gt; price        -0.0015377720</span>
<span class="co">#&gt; feat         -0.0018213311</span>
<span class="co">#&gt; brandhiland  -0.0036810363</span>
<span class="co">#&gt; brandweight   0.0007779428</span>
<span class="co">#&gt; brandyoplait  0.0065031782</span></code></pre></div>
<p><strong>The coefficient standard errors</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">mnl_pref</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        price         feat  brandhiland  brandweight brandyoplait </span>
<span class="co">#&gt;   0.02436526   0.12006175   0.14541671   0.05449794   0.08064229</span></code></pre></div>
</div>
<div id="computing-and-comparing-wtp" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-and-comparing-wtp" class="anchor"></a>Computing and comparing WTP</h2>
<p>For models in the preference space, a summary table of the computed WTP based on the estimated preference space parameters can be obtained with the <code><a href="../reference/wtp.html">wtp()</a></code> function. For example, the computed WTP from the previously estimated fixed parameter model can be obtained with the following command:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wtp.html">wtp</a></span><span class="op">(</span><span class="va">mnl_pref</span>, price <span class="op">=</span> <span class="st">"price"</span><span class="op">)</span>
<span class="co">#&gt;                 Estimate Std. Error    z-value     Pr(&gt;|z|)</span>
<span class="co">#&gt; lambda         0.3665546 0.02442413  15.007885 0.0000000000</span>
<span class="co">#&gt; feat           1.3406987 0.35926130   3.731821 0.0001901009</span>
<span class="co">#&gt; brandhiland  -10.1362190 0.58475604 -17.334099 0.0000000000</span>
<span class="co">#&gt; brandweight   -1.7490940 0.18247764  -9.585251 0.0000000000</span>
<span class="co">#&gt; brandyoplait   2.0038476 0.14361235  13.953171 0.0000000000</span></code></pre></div>
<p>The <code><a href="../reference/wtp.html">wtp()</a></code> function divides the non-price parameters by the negative of the price parameter. Standard errors are estimated using the Krinsky and Robb parametric bootstrapping method <span class="citation">[@Krinsky1986]</span>. Similarly, the <code><a href="../reference/wtpCompare.html">wtpCompare()</a></code> function can be used to compare the WTP from a WTP space model with that computed from an equivalent preference space model:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wtpCompare.html">wtpCompare</a></span><span class="op">(</span><span class="va">mnl_pref</span>, <span class="va">mnl_wtp</span>, price <span class="op">=</span> <span class="st">"price"</span><span class="op">)</span>
<span class="co">#&gt;                       pref           wtp  difference</span>
<span class="co">#&gt; lambda           0.3665546     0.3665808  0.00002628</span>
<span class="co">#&gt; feat             1.3406987     1.3405974 -0.00010124</span>
<span class="co">#&gt; brandhiland    -10.1362190   -10.1358337  0.00038529</span>
<span class="co">#&gt; brandweight     -1.7490940    -1.7491007 -0.00000678</span>
<span class="co">#&gt; brandyoplait     2.0038476     2.0038646  0.00001700</span>
<span class="co">#&gt; logLik       -2656.8878790 -2656.8878780  0.00000097</span></code></pre></div>
</div>
<div id="predicting-choice-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#predicting-choice-probabilities" class="anchor"></a>Predicting choice probabilities</h2>
<p>Estimated models can be used to predict expected choices and choice probabilities for a set (or multiple sets) of alternatives based on an estimated model. As an example, consider predicting choice probabilities for two of the choice observations from the <code>yogurt</code> dataset:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>
  <span class="va">yogurt</span>, <span class="va">obsID</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">13</span><span class="op">)</span>,
  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'obsID'</span>, <span class="st">'alt'</span>, <span class="st">'choice'</span>, <span class="st">'price'</span>, <span class="st">'feat'</span>, <span class="st">'brand'</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">alts</span>
<span class="co">#&gt;     obsID alt choice price feat   brand</span>
<span class="co">#&gt; 49     13   1      0   8.1    0  dannon</span>
<span class="co">#&gt; 50     13   2      0   5.0    0  hiland</span>
<span class="co">#&gt; 51     13   3      1   8.6    0  weight</span>
<span class="co">#&gt; 52     13   4      0  10.8    0 yoplait</span>
<span class="co">#&gt; 165    42   1      1   6.3    0  dannon</span>
<span class="co">#&gt; 166    42   2      0   6.1    1  hiland</span>
<span class="co">#&gt; 167    42   3      0   7.9    0  weight</span>
<span class="co">#&gt; 168    42   4      0  11.5    0 yoplait</span></code></pre></div>
<p>In the example below, the expected choice probabilities for these two sets of alternatives are computed using the fixed parameter <code>mnl_pref</code> model:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictProbs.html">predictProbs</a></span><span class="op">(</span>
  model <span class="op">=</span> <span class="va">mnl_pref</span>,
  alts  <span class="op">=</span> <span class="va">alts</span>,
  altID <span class="op">=</span> <span class="st">"alt"</span>,
  obsID <span class="op">=</span> <span class="st">"obsID"</span>
<span class="op">)</span>

<span class="va">probs</span>
<span class="co">#&gt;     obsID alt  prob_mean   prob_low  prob_high</span>
<span class="co">#&gt; 49     13   1 0.43685145 0.41536587 0.45813948</span>
<span class="co">#&gt; 50     13   2 0.03312986 0.02637371 0.04159566</span>
<span class="co">#&gt; 51     13   3 0.19155548 0.17605071 0.20786349</span>
<span class="co">#&gt; 52     13   4 0.33846321 0.31880061 0.35861389</span>
<span class="co">#&gt; 165    42   1 0.60764778 0.57309552 0.64126111</span>
<span class="co">#&gt; 166    42   2 0.02602007 0.01824937 0.03666824</span>
<span class="co">#&gt; 167    42   3 0.17803313 0.16197248 0.19476048</span>
<span class="co">#&gt; 168    42   4 0.18829902 0.16792358 0.20977876</span></code></pre></div>
<p>The resulting <code>probs</code> data frame contains the expected choice probabilities for each alternative. The low and high values show a 95% confidence interval, estimated using the Krinsky and Robb parametric bootstrapping method <span class="citation">[@Krinsky1986]</span>. You can change the CI level by setting alpha to a different value (e.g. a 90% CI is obtained with alpha = 0.05).</p>
<p>Choice probabilities can also be predicted used WTP space models. For example, the predicted choice probabilities using the <code>mnl_wtp</code> model are nearly identical with those from the <code>mnl_pref</code> model:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictProbs.html">predictProbs</a></span><span class="op">(</span>
  model <span class="op">=</span> <span class="va">mnl_wtp</span>,
  alts  <span class="op">=</span> <span class="va">alts</span>,
  altID <span class="op">=</span> <span class="st">"alt"</span>,
  obsID <span class="op">=</span> <span class="st">"obsID"</span>
<span class="op">)</span>

<span class="va">probs</span>
<span class="co">#&gt;     obsID alt  prob_mean   prob_low  prob_high</span>
<span class="co">#&gt; 49     13   1 0.43685902 0.41531343 0.45774934</span>
<span class="co">#&gt; 50     13   2 0.03312899 0.02653068 0.04244477</span>
<span class="co">#&gt; 51     13   3 0.19154700 0.17581818 0.20739009</span>
<span class="co">#&gt; 52     13   4 0.33846499 0.31874269 0.35855039</span>
<span class="co">#&gt; 165    42   1 0.60766839 0.57255518 0.63927184</span>
<span class="co">#&gt; 166    42   2 0.02601779 0.01835179 0.03678042</span>
<span class="co">#&gt; 167    42   3 0.17802306 0.16183805 0.19450009</span>
<span class="co">#&gt; 168    42   4 0.18829076 0.16750612 0.20913217</span></code></pre></div>
<p>See the <a href="predict_probs.html">“Predicting Choice Probabilities from Estimated Models”</a> vignette for more details.</p>
</div>
<div id="predicting-choices" class="section level2">
<h2 class="hasAnchor">
<a href="#predicting-choices" class="anchor"></a>Predicting choices</h2>
<p>Similar to the <code><a href="../reference/predictProbs.html">predictProbs()</a></code> function, the <code><a href="../reference/predictChoices.html">predictChoices()</a></code> function can be used to predict choices using the results of an estimated model. In the example below, choices are predicted for the entire <code>yogurt</code> dataset, which was used to the estimate the <code>mnl_pref</code> model:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">choices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictChoices.html">predictChoices</a></span><span class="op">(</span>
  model <span class="op">=</span> <span class="va">mnl_pref</span>,
  alts  <span class="op">=</span> <span class="va">yogurt</span>,
  altID <span class="op">=</span> <span class="st">"alt"</span>,
  obsID <span class="op">=</span> <span class="st">"obsID"</span>
<span class="op">)</span>

<span class="co"># Preview actual and predicted choices</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">choices</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'obsID'</span>, <span class="st">'choice'</span>, <span class="st">'choice_predict'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;     obsID choice choice_predict</span>
<span class="co">#&gt; 1.1     1      0              0</span>
<span class="co">#&gt; 1.2     1      0              0</span>
<span class="co">#&gt; 1.3     1      1              0</span>
<span class="co">#&gt; 1.4     1      0              1</span>
<span class="co">#&gt; 2.5     2      1              0</span>
<span class="co">#&gt; 2.6     2      0              0</span></code></pre></div>
<p>The resulting <code>choices</code> data frame contains the same <code>alts</code> data frame with an additional column, <code>choice_predict</code>, which contains the predicted choices. You can quickly compute the accuracy by dividing the number of correctly predicted choices by the total number of choices:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chosen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">choices</span>, <span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">chosen</span><span class="op">$</span><span class="va">correct</span> <span class="op">&lt;-</span> <span class="va">chosen</span><span class="op">$</span><span class="va">choice</span> <span class="op">==</span> <span class="va">chosen</span><span class="op">$</span><span class="va">choice_predict</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">chosen</span><span class="op">$</span><span class="va">correct</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">chosen</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.3702322</span></code></pre></div>
<p>See the <a href="predict_choices.html">“Predicting Choices from Estimated Models”</a> vignette for more details.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Helveston.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
